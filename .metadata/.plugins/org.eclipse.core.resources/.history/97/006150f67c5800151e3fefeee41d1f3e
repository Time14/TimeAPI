package time.api.gamestate;

import time.api.library.Library;

public class GameStateManager {
	
	private Library<GameState> gameStateLibrary;
	
	private GameState currentState;
	
	public GameStateManager() {
		gameStateLibrary = new Library<>("GameStateLibrary");
	}
	
	/**
	 * 
	 * Registers a new GameState to this GameStateManager.
	 * 
	 * @param gs - the GameState to register
	 * @return this GameStateManager instance
	 */
	public GameStateManager registerState(GameState gs) {
		gameStateLibrary.put(gs.NAME, gs);
		return this;
	}
	
	/**
	 * 
	 * Exits the current GameState and initiates a new one with the corresponding key specified.
	 * 
	 * @param key - the key to fetch the GameState from
	 * @return this GameStateManager instance
	 */
	public GameStateManager enterState(String key) {
		return enterState(gameStateLibrary.get(key));
	}
	
	
	/**
	 * 
	 * Exits the current GameState and initiates the one specified.
	 * 
	 * @param gs - the new GameState
	 * @return this GameStateManager instance
	 */
	public GameStateManager enterState(GameState gs) {
		if(currentState != null)
			currentState.exit();
		
		currentState = gs;
		
		currentState.init();
		
		return this;
	}
	
	/**
	 * 
	 * 
	 * 
	 * @param dt - the delta time
	 */
	public void update(float dt) {
		currentState.input();
		currentState.update(dt);
		currentState.draw();
	}
}